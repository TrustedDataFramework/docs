##  7.1 账户结构

&#160;&#160;&#160;&#160;&#160;&#160;普通账户与合约账户都用以下结构表示


| 字段名     |   类型   | 说明 |
| ---- | ---- | ---- |
| address | bytes | 账户地址，二十个字节 |
| nonce |   long   | 递增序号 |
|  balance  |   long   | 账户余额，对于合约账户此字段永远为0 |
| createdBy | bytes | 合约的创建者，普通账户此字段为空 |
| contractHash | bytes | 合约代码的哈希值，普通账户此字段为空 |
| storageRoot | bytes | 合约存储树树根，普通账户此字段为空 |


## 7.2 普通账户

&#160;&#160;&#160;&#160;&#160;&#160;普通账户的地址由公钥计算得到。
普通账号可以用椭圆曲线密钥对表示，包含公钥和私钥，默认采用的椭圆曲线是sm2。


&#160;&#160;&#160;&#160;&#160;&#160;普通账户的地址生成是对公钥作一次哈希值计算后，取公钥的后面20个字节，伪代码如下：

```nodejs
h = sm3(publicKey)
address = h[len(h) - 20:]
```

&#160;&#160;&#160;&#160;&#160;&#160;nonce 用于防止重放攻击，当用普通账户构造事务时，需要保证事务的 nonce 等于当前账户的nonce 加一，用伪代码可以这样表示：

```nodejs
nonce = getNonce(publicKey)
transaction['type'] = 1 # 这里用的是转账事务，也可以 2或者3
transaction['from'] = publicKey
transaction['nonce'] = nonce + 1
```

&#160;&#160;&#160;&#160;&#160;&#160;balance 是账户的余额

## 7.3 合约账户

&#160;&#160;&#160;&#160;&#160;&#160;合约账户是普通账户部署合约时生成的，合约地址的生成用伪代码表示:

```nodejs
b = sm3(rlp.encode([publicKey, nonce]))
address = h[len(b) - 20:]
```

&#160;&#160;&#160;&#160;&#160;&#160;合约地址是把 合约部署者的公钥和部署合约事务的 nonce 作了 rlp 编码后，计算哈希值，然后取最后 20 个字节

&#160;&#160;&#160;&#160;&#160;&#160;合约账户没有对应的私钥和公钥，合约账户的 nonce 值等于部署合约事务的 nonce，而且这个nonce不会再改变

&#160;&#160;&#160;&#160;&#160;&#160;每个合约账户都有自己独立的存储空间，这个存储空间实际上是一个梅克尔-帕特里夏树，合约账户的状态可以用梅克尔-帕特里夏树的树根表示，也就是 storageRoot 字段